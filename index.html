<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å® ç‰©ç»¼åˆä½“ç»è¥æµ‹ç®— v2.0</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <meta name="description" content="ä¸“ä¸šçš„å® ç‰©ç»¼åˆä½“è´¢åŠ¡å»ºæ¨¡å·¥å…·ï¼Œæ”¯æŒæ”¶å…¥é¢„æµ‹ã€æˆæœ¬åˆ†æã€æŠ•èµ„å›æŠ¥è®¡ç®—å’Œæƒ…æ™¯åˆ†æ">
  <meta name="keywords" content="å® ç‰©ç»¼åˆä½“,ç»è¥æµ‹ç®—,è´¢åŠ¡å»ºæ¨¡,æŠ•èµ„å›æŠ¥,ç›ˆäºå¹³è¡¡">
  
  <!-- å¤–éƒ¨ä¾èµ– -->
  <script src="https://unpkg.com/react@17/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script src="https://unpkg.com/dayjs@1.11.9/dayjs.min.js"></script>
  <script src="https://unpkg.com/dayjs@1.11.9/locale/zh-cn.js"></script>
  
  <!-- Ant Design CDN -->
  <link rel="stylesheet" href="https://unpkg.com/antd@5.12.8/dist/reset.css" />
  <script src="https://unpkg.com/antd@5.12.8/dist/antd.min.js"></script>
  
  <!-- ä¿ç•™ Tailwind ç”¨äºè‡ªå®šä¹‰æ ·å¼ -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  
  <!-- è‡ªå®šä¹‰æ ·å¼ -->
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }
    
    /* åŠ è½½åŠ¨ç”» */
    .loading-spinner {
      border: 2px solid #f3f4f6;
      border-top: 2px solid #3b82f6;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* é”™è¯¯çŠ¶æ€æ ·å¼ */
    .error-state {
      background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
    }
    
    /* æˆåŠŸçŠ¶æ€æ ·å¼ */
    .success-state {
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
    }
    
    /* å¹³æ»‘è¿‡æ¸¡ */
    .transition-all {
      transition: all 0.3s ease;
    }
    
    /* å“åº”å¼è°ƒæ•´ */
    @media (max-width: 640px) {
      .container {
        padding-left: 1rem;
        padding-right: 1rem;
      }
    }
    
    /* æ‰“å°æ ·å¼ */
    @media print {
      .no-print {
        display: none !important;
      }
      
      body {
        background: white !important;
      }
      
      .shadow {
        box-shadow: none !important;
      }
    }
  </style>
</head>
<body>
  <!-- åº”ç”¨æ ¹èŠ‚ç‚¹ -->
  <div id="root">
    <!-- åˆå§‹åŠ è½½çŠ¶æ€ -->
    <div class="min-h-screen bg-gradient-to-br from-blue-50 to-cyan-50 flex items-center justify-center">
      <div class="bg-white rounded-2xl shadow-xl p-8 text-center max-w-md">
        <div class="text-6xl mb-4">ğŸ¾</div>
        <h1 class="text-2xl font-bold text-gray-800 mb-4">å® ç‰©ç»¼åˆä½“ç»è¥æµ‹ç®—</h1>
        <p class="text-gray-600 mb-6">v2.0 æ¨¡å—åŒ–ç‰ˆæœ¬</p>
        <div class="loading-spinner mx-auto mb-4"></div>
        <p class="text-sm text-gray-500">æ­£åœ¨åŠ è½½æ¨¡å—...</p>
      </div>
    </div>
    <!-- ç‰ˆæœ¬å· -->
    <div class="fixed bottom-2 right-2 text-xs text-gray-400">v2.0.0</div>
  </div>

  <!-- æ ¸å¿ƒæ¨¡å—åŠ è½½ -->
  <script>
    // æ¨¡å—åŠ è½½çŠ¶æ€è·Ÿè¸ª
    let loadedModules = 0;
    const totalModules = 60; // å®é™…åŠ è½½çš„scriptæ•°é‡
    
    function updateLoadingProgress() {
      loadedModules++;
      const progress = (loadedModules / totalModules) * 100;
      
      // åªåœ¨å…³é”®è¿›åº¦ç‚¹æ˜¾ç¤ºæ—¥å¿—
      if (loadedModules === 1 || loadedModules % 10 === 0 || loadedModules >= totalModules) {
        console.log(`ğŸ“¦ åŠ è½½è¿›åº¦: ${progress.toFixed(0)}% (${loadedModules}/${totalModules})`);
      }
      
      // æ›´æ–°é¡µé¢åŠ è½½æŒ‡ç¤ºå™¨ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
      const loadingIndicator = document.getElementById('loading-indicator');
      if (loadingIndicator) {
        loadingIndicator.textContent = `åŠ è½½ä¸­... ${progress.toFixed(0)}%`;
      }
      
      // æ‰€æœ‰æ¨¡å—åŠ è½½å®Œæˆåï¼Œè§¦å‘åº”ç”¨å¯åŠ¨æ£€æŸ¥
      if (loadedModules >= totalModules && !window.modulesLoadComplete) {
        window.modulesLoadComplete = true;
        console.log('ğŸ‰ æ‰€æœ‰æ¨¡å—åŠ è½½å®Œæˆï¼Œå¯åŠ¨åº”ç”¨...');
        setTimeout(() => {
          if (window.startApp) {
            window.startApp();
          }
        }, 300); // ç»™æ¨¡å—æ³¨å†Œæ›´å¤šæ—¶é—´
      }
    }
    
    // æ¨¡å—åŠ è½½é”™è¯¯å¤„ç†
    function handleModuleError(moduleName, error) {
      console.error(`æ¨¡å— ${moduleName} åŠ è½½å¤±è´¥:`, error);
      document.getElementById('root').innerHTML = `
        <div class="min-h-screen bg-red-50 flex items-center justify-center p-4">
          <div class="bg-white rounded-2xl shadow-xl p-8 max-w-md text-center">
            <div class="text-6xl mb-4">âŒ</div>
            <h2 class="text-xl font-bold text-red-600 mb-4">æ¨¡å—åŠ è½½å¤±è´¥</h2>
            <p class="text-gray-600 mb-4">æ¨¡å— <code>${moduleName}</code> æ— æ³•åŠ è½½</p>
            <p class="text-sm text-gray-500 mb-6">è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è”ç³»æŠ€æœ¯æ”¯æŒ</p>
            <button 
              class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
              onclick="window.location.reload()"
            >
              é‡æ–°åŠ è½½
            </button>
          </div>
        </div>
      `;
    }
  </script>

  <!-- 1. æ•°æ®ç®¡ç†æ ¸å¿ƒ -->
  <script src="js/core/data-manager.js" onerror="handleModuleError('DataManager', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 2. å…¬å¼å¼•æ“ -->
  <script src="js/core/formula-engine.js" onerror="handleModuleError('FormulaEngine', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 3. è®¡ç®—å™¨å¼•æ“ (æ‹†åˆ†å) -->
  <script src="js/core/calculators/revenue-calculator.js" onerror="handleModuleError('RevenueCalculator', event)" onload="updateLoadingProgress()"></script>
  <script src="js/core/calculators/cost-calculator.js" onerror="handleModuleError('CostCalculator', event)" onload="updateLoadingProgress()"></script>
  <script src="js/core/calculators/investment-calculator.js" onerror="handleModuleError('InvestmentCalculator', event)" onload="updateLoadingProgress()"></script>
  <script src="js/core/calculators/profitability-calculator.js" onerror="handleModuleError('ProfitabilityCalculator', event)" onload="updateLoadingProgress()"></script>
  <script src="js/core/calculators/breakeven-calculator.js" onerror="handleModuleError('BreakevenCalculator', event)" onload="updateLoadingProgress()"></script>
  <script src="js/core/calculators/scenario-calculator.js" onerror="handleModuleError('ScenarioCalculator', event)" onload="updateLoadingProgress()"></script>
  <script src="js/core/calculators/analysis-helper.js" onerror="handleModuleError('AnalysisHelper', event)" onload="updateLoadingProgress()"></script>
  <script src="js/core/calculators/main-calculator.js" onerror="handleModuleError('MainCalculator', event)" onload="updateLoadingProgress()"></script>
  <script src="js/core/calculators/index.js" onerror="handleModuleError('Calculator', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 4. UIç»„ä»¶åº“ (Ant Designç‰ˆæœ¬) -->
  <script src="js/components/ui-components-antd.js" onerror="handleModuleError('UIComponents', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 5. å›¾è¡¨ç»„ä»¶ (æ‹†åˆ†å) -->
  <script src="js/components/charts/revenue-chart.js" onerror="handleModuleError('RevenueChart', event)" onload="updateLoadingProgress()"></script>
  <script src="js/components/charts/cost-chart.js" onerror="handleModuleError('CostChart', event)" onload="updateLoadingProgress()"></script>
  <script src="js/components/charts/breakeven-chart.js" onerror="handleModuleError('BreakevenChart', event)" onload="updateLoadingProgress()"></script>
  <script src="js/components/charts/scenario-chart.js" onerror="handleModuleError('ScenarioChart', event)" onload="updateLoadingProgress()"></script>
  <script src="js/components/charts/breakeven-svg-chart.js" onerror="handleModuleError('BreakevenSVGChart', event)" onload="updateLoadingProgress()"></script>
  <script src="js/components/charts/margin-chart.js" onerror="handleModuleError('MarginChart', event)" onload="updateLoadingProgress()"></script>
  <script src="js/components/charts/index.js" onerror="handleModuleError('ChartComponents', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 6. å…¬å¼æ˜¾ç¤ºç»„ä»¶ -->
  <script src="js/components/formula-display.js" onerror="handleModuleError('FormulaDisplay', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 7. è®¾ç½®ç»„ä»¶æ¨¡å— -->
  <script src="js/components/settings/basic-settings.js" onerror="handleModuleError('BasicSettings', event)" onload="updateLoadingProgress()"></script>
  <script src="js/components/settings/revenue-settings.js" onerror="handleModuleError('RevenueSettings', event)" onload="updateLoadingProgress()"></script>
  <script src="js/components/settings/investment-settings.js" onerror="handleModuleError('InvestmentSettings', event)" onload="updateLoadingProgress()"></script>
  <script src="js/components/settings/cost-settings.js" onerror="handleModuleError('CostSettings', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 8. è‡ªå®šä¹‰æ¨¡å—ç®¡ç† (æ‹†åˆ†åçš„ä¸šåŠ¡æ¨¡å—) -->
  <script src="js/modules/business/module-editor.js" onerror="handleModuleError('ModuleEditor', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/business/formula-help.js" onerror="handleModuleError('FormulaHelp', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/business/revenue-manager.js" onerror="handleModuleError('RevenueManager', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/business/cost-manager.js" onerror="handleModuleError('CostManager', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/business/investment-manager.js" onerror="handleModuleError('InvestmentManager', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/business/index.js" onerror="handleModuleError('CustomModules', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 9. ç›ˆäºå¹³è¡¡åˆ†ææ¨¡å— (æ‹†åˆ†å) -->
  <script src="js/modules/breakeven/utils.js" onerror="handleModuleError('BreakevenUtils', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/analysis-core.js" onerror="handleModuleError('BreakevenCore', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/risk-tolerance.js" onerror="handleModuleError('RiskTolerance', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/target-margin-calc.js" onerror="handleModuleError('TargetMarginCalc', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/target-margin.js" onerror="handleModuleError('TargetMargin', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/sensitivity-calc.js" onerror="handleModuleError('SensitivityCalc', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/sensitivity.js" onerror="handleModuleError('Sensitivity', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/visualization-svg.js" onerror="handleModuleError('VisualizationSVG', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/visualization-data.js" onerror="handleModuleError('VisualizationData', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/insights-analysis.js" onerror="handleModuleError('InsightsAnalysis', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/visualization-insights.js" onerror="handleModuleError('VisualizationInsights', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/visualization-core.js" onerror="handleModuleError('VisualizationCore', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/visualization.js" onerror="handleModuleError('Visualization', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/breakeven/index.js" onerror="handleModuleError('BreakevenAnalysis', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 10. æƒ…æ™¯åˆ†ææ¨¡å— (æ‹†åˆ†å) -->
  <script src="js/modules/scenario/parameters.js" onerror="handleModuleError('ScenarioParameters', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/scenario/comparison.js" onerror="handleModuleError('ScenarioComparison', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/scenario/chart.js" onerror="handleModuleError('ScenarioChart', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/scenario/insights.js" onerror="handleModuleError('ScenarioInsights', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/scenario/recommendations.js" onerror="handleModuleError('ScenarioRecommendations', event)" onload="updateLoadingProgress()"></script>
  <script src="js/modules/scenario/index.js" onerror="handleModuleError('ScenarioAnalysis', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 11. æ¦‚è§ˆé¡µé¢ -->
  <script src="js/pages/overview-page.js" onerror="handleModuleError('OverviewPage', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 12. è®¾ç½®é¡µé¢ (v2.0 åŒæ å¸ƒå±€) -->
  <script src="js/pages/settings-page-v2.js" onerror="handleModuleError('SettingsPage', event)" onload="updateLoadingProgress()"></script>
  
  <!-- 13. åˆ†æé¡µé¢ -->
  <script src="js/pages/analysis-page.js" onerror="handleModuleError('AnalysisPage', event)" onload="updateLoadingProgress()"></script>
  
  <!-- ä¸»åº”ç”¨å¯åŠ¨ -->
  <script src="app.js" onerror="handleModuleError('App', event)"></script>

  <!-- Google Analytics (å¯é€‰) -->
  <!--
  <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'GA_MEASUREMENT_ID');
  </script>
  -->

  <!-- æœåŠ¡å·¥ä½œè€…æ³¨å†Œ (PWAæ”¯æŒï¼Œå¯é€‰) -->
  <!--
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/sw.js')
          .then(function(registration) {
            console.log('SW registered: ', registration);
          }).catch(function(registrationError) {
            console.log('SW registration failed: ', registrationError);
          });
      });
    }
  </script>
  -->

</body>
</html>